/*! For license information please see embed.js.LICENSE.txt */
var Coral=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=9)}([,function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!u){var e=a(f);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||u||a(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(i){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){(function(r,i){var o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}!function(a){var c=Object.hasOwnProperty,l=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},u="object"==(void 0===r?"undefined":s(r))&&"function"==typeof r.nextTick,h="function"==typeof Symbol,f="object"===("undefined"==typeof Reflect?"undefined":s(Reflect)),d="function"==typeof i?i:setTimeout,m=h?f&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function p(){this._events={},this._conf&&v.call(this,this._conf)}function v(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==a&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function g(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),void 0!==r&&r.emitWarning){var i=new Error(n);i.name="MaxListenersExceededWarning",i.emitter=this,i.count=e,r.emitWarning(i)}else console.error(n),console.trace&&console.trace()}var y=function(e,t,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function b(e,t){for(var n={},r=e.length,i=t?value.length:0,o=0;o<r;o++)n[e[o]]=o<i?t[o]:a;return n}function w(e,t,n){var r,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),t.addEventListener?(r=t.addEventListener,i=t.removeEventListener):t.addListener?(r=t.addListener,i=t.removeListener):t.on&&(r=t.on,i=t.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function _(e,t,n,r){var i=Object.assign({},t);if(!e)return i;if("object"!==s(e))throw TypeError("options must be an object");var o,l,u,h=Object.keys(e),f=h.length;function d(e){throw Error('Invalid "'+o+'" option value'+(e?". Reason: "+e:""))}for(var m=0;m<f;m++){if(o=h[m],!r&&!c.call(t,o))throw Error('Unknown "'+o+'" option');(l=e[o])!==a&&(u=n[o],i[o]=u?u(l,d):l)}return i}function E(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function k(e){var t="value must be type of "+e.join("|"),n=e.length,r=e[0],i=e[1];return 1===n?function(e,n){if(s(e)===r)return e;n(t)}:2===n?function(e,n){var o=s(e);if(o===r||o===i)return e;n(t)}:function(r,i){for(var o=s(r),a=n;a-- >0;)if(o===e[a])return r;i(t)}}Object.assign(w.prototype,{subscribe:function(e,t,n){var r=this,i=this._target,o=this._emitter,s=this._listeners,a=function(){var r=y.apply(null,arguments),s={data:r,name:t,original:e};if(n){var a=n.call(i,s);!1!==a&&o.emit.apply(o,[s.name].concat(r))}else o.emit.apply(o,[t].concat(r))};if(s[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===t&&null===s[e]&&(s[e]=a,r._on.call(i,e,a))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!o.hasListeners(n)&&s[e]&&(s[e]=null,r._off.call(i,e,a))},s[e]=null,o.on("removeListener",this._onRemoveListener)):(s[e]=a,r._on.call(i,e,a))},unsubscribe:function(e){var t,n,r,i=this,o=this._listeners,s=this._emitter,a=this._off,c=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function l(){i._onNewListener&&(s.off("newListener",i._onNewListener),s.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=x.call(s,i);s._observers.splice(e,1)}if(e){if(!(t=o[e]))return;a.call(c,e,t),delete o[e],--this._listenersCount||l()}else{for(r=(n=m(o)).length;r-- >0;)e=n[r],a.call(c,e,o[e]);this._listeners={},this._listenersCount=0,l()}}});var I=k(["function"]),T=k(["object","function"]);function L(e,t,n){var r,i,o,s=0,a=new e((function(c,l,u){function h(){i&&(i=null),s&&(clearTimeout(s),s=0)}n=_(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),r=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var f=function(e){h(),c(e)},d=function(e){h(),l(e)};r?t(f,d,u):(i=[function(e){d(e||Error("canceled"))}],t(f,d,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),n.timeout>0&&(s=setTimeout((function(){var e=Error("timeout");s=0,a.cancel(e),l(e)}),n.timeout))}));return r||(a.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),a}function x(e){var t=this._observers;if(!t)return-1;for(var n=t.length,r=0;r<n;r++)if(t[r]._target===e)return r;return-1}function M(e,t,n,r,i){if(!n)return null;if(0===r){var o=s(t);if("string"===o){var a,c,l=0,u=0,h=this.delimiter,f=h.length;if(-1!==(c=t.indexOf(h))){a=new Array(5);do{a[l++]=t.slice(u,c),u=c+f}while(-1!==(c=t.indexOf(h,u)));a[l++]=t.slice(u),t=a,i=l}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var d,p,v,g,y,b,w,_=null,E=t[r],k=t[r+1];if(r===i&&n._listeners)return"function"==typeof n._listeners?(e&&e.push(n._listeners),[n]):(e&&e.push.apply(e,n._listeners),[n]);if("*"===E){for(c=(b=m(n)).length;c-- >0;)"_listeners"!==(d=b[c])&&(w=M(e,t,n[d],r+1,i))&&(_?_.push.apply(_,w):_=w);return _}if("**"===E){for((y=r+1===i||r+2===i&&"*"===k)&&n._listeners&&(_=M(e,t,n,i,i)),c=(b=m(n)).length;c-- >0;)"_listeners"!==(d=b[c])&&("*"===d||"**"===d?(n[d]._listeners&&!y&&(w=M(e,t,n[d],i,i))&&(_?_.push.apply(_,w):_=w),w=M(e,t,n[d],r,i)):w=M(e,t,n[d],d===k?r+2:r,i),w&&(_?_.push.apply(_,w):_=w));return _}if(n[E]&&(_=M(e,t,n[E],r+1,i)),(p=n["*"])&&M(e,t,p,r+1,i),v=n["**"])if(r<i)for(v._listeners&&M(e,t,v,i,i),c=(b=m(v)).length;c-- >0;)"_listeners"!==(d=b[c])&&(d===k?M(e,t,v[d],r+2,i):d===E?M(e,t,v[d],r+1,i):((g={})[d]=v[d],M(e,t,{"**":g},r+1,i)));else v._listeners?M(e,t,v,i,i):v["*"]&&v["*"]._listeners&&M(e,t,v["*"],i,i);return _}function O(e,t){var n,r,i=0,o=0,s=this.delimiter,a=s.length;if("string"==typeof e)if(-1!==(n=e.indexOf(s))){r=new Array(5);do{r[i++]=e.slice(o,n),o=n+a}while(-1!==(n=e.indexOf(s,o)));r[i++]=e.slice(o)}else r=[e],i=1;else r=e,i=e.length;if(i>1)for(n=0;n+1<i;n++)if("**"===r[n]&&"**"===r[n+1])return;var c,l=this.listenerTree;for(n=0;n<i;n++)if(l=l[c=r[n]]||(l[c]={}),n===i-1)return l._listeners?("function"==typeof l._listeners&&(l._listeners=[l._listeners]),l._listeners.push(t),!l._listeners.warned&&this._maxListeners>0&&l._listeners.length>this._maxListeners&&(l._listeners.warned=!0,g.call(this,l._listeners.length,c))):l._listeners=t,!0;return!0}function S(e,t,n,r){for(var i,o,a,c,l=m(e),u=l.length,h=e._listeners;u-- >0;)i=e[o=l[u]],a="_listeners"===o?n:n?n.concat(o):[o],c=r||"symbol"===s(o),h&&t.push(c?a:a.join(this.delimiter)),"object"===s(i)&&S.call(this,i,t,a,c);return t}function R(e){for(var t,n,r,i=m(e),o=i.length;o-- >0;)(t=e[n=i[o]])&&(r=!0,"_listeners"===n||R(t)||delete e[n]);return r}function j(e,t,n){this.emitter=e,this.event=t,this.listener=n}function A(e,t,n){if(!0===n)o=!0;else if(!1===n)i=!0;else{if(!n||"object"!==s(n))throw TypeError("options should be an object or true");var i=n.async,o=n.promisify,c=n.nextTick,l=n.objectify}if(i||c||o){var h=t,f=t._origin||t;if(c&&!u)throw Error("process.nextTick is not supported");o===a&&(o="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return o?c?Promise.resolve():new Promise((function(e){d(e)})).then((function(){return t.event=n,h.apply(t,e)})):(c?r.nextTick:d)((function(){t.event=n,h.apply(t,e)}))},t._async=!0,t._origin=f}return[t,l?new j(this,e,t):this]}function C(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,v.call(this,e)}j.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},C.EventEmitter2=C,C.prototype.listenTo=function(e,t,n){if("object"!==s(e))throw TypeError("target musts be an object");var r=this;function i(t){if("object"!==s(t))throw TypeError("events must be an object");var i,o=n.reducers,a=x.call(r,e);i=-1===a?new w(r,e,n):r._observers[a];for(var c,l=m(t),u=l.length,h="function"==typeof o,f=0;f<u;f++)c=l[f],i.subscribe(c,t[c]||c,h?o:o&&o[c])}return n=_(n,{on:a,off:a,reducers:a},{on:I,off:I,reducers:T}),l(t)?i(b(t)):i("string"==typeof t?b(t.split(/\s+/)):t),this},C.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var r,i=n.length,o=!1;if(e&&"object"!==s(e))throw TypeError("target should be an object");for(;i-- >0;)r=n[i],e&&r._target!==e||(r.unsubscribe(t),o=!0);return o},C.prototype.delimiter=".",C.prototype.setMaxListeners=function(e){e!==a&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},C.prototype.getMaxListeners=function(){return this._maxListeners},C.prototype.event="",C.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},C.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},C.prototype._once=function(e,t,n,r){return this._many(e,1,t,n,r)},C.prototype.many=function(e,t,n,r){return this._many(e,t,n,!1,r)},C.prototype.prependMany=function(e,t,n,r){return this._many(e,t,n,!0,r)},C.prototype._many=function(e,t,n,r,i){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&o.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,r,i)},C.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,r,i,o,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return!1;if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"===s(a))){if(n=a.length,h)for(r=0;r<n;r++)if("symbol"===s(a[r])){o=!0;break}o||(a=a.join(this.delimiter))}var l,u=arguments.length;if(this._all&&this._all.length)for(r=0,n=(l=this._all.slice()).length;r<n;r++)switch(this.event=a,u){case 1:l[r].call(this,a);break;case 2:l[r].call(this,a,arguments[1]);break;case 3:l[r].call(this,a,arguments[1],arguments[2]);break;default:l[r].apply(this,arguments)}if(c)l=[],M.call(this,l,e,this.listenerTree,0,n);else{if("function"==typeof(l=this._events[a])){switch(this.event=a,u){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];l.apply(this,t)}return!0}l&&(l=l.slice())}if(l&&l.length){if(u>3)for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];for(r=0,n=l.length;r<n;r++)switch(this.event=a,u){case 1:l[r].call(this);break;case 2:l[r].call(this,arguments[1]);break;case 3:l[r].call(this,arguments[1],arguments[2]);break;default:l[r].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===a)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},C.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,r,i,o,a=arguments[0],c=this.wildcard;if("newListener"===a&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(c&&(e=a,"newListener"!==a&&"removeListener"!==a&&"object"===s(a))){if(r=a.length,h)for(i=0;i<r;i++)if("symbol"===s(a[i])){t=!0;break}t||(a=a.join(this.delimiter))}var l,u=[],f=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=a,f){case 1:u.push(this._all[i].call(this,a));break;case 2:u.push(this._all[i].call(this,a,arguments[1]));break;case 3:u.push(this._all[i].call(this,a,arguments[1],arguments[2]));break;default:u.push(this._all[i].apply(this,arguments))}if(c?(l=[],M.call(this,l,e,this.listenerTree,0)):l=this._events[a],"function"==typeof l)switch(this.event=a,f){case 1:u.push(l.call(this));break;case 2:u.push(l.call(this,arguments[1]));break;case 3:u.push(l.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];u.push(l.apply(this,n))}else if(l&&l.length){if(l=l.slice(),f>3)for(n=new Array(f-1),o=1;o<f;o++)n[o-1]=arguments[o];for(i=0,r=l.length;i<r;i++)switch(this.event=a,f){case 1:u.push(l[i].call(this));break;case 2:u.push(l[i].call(this,arguments[1]));break;case 3:u.push(l[i].call(this,arguments[1],arguments[2]));break;default:u.push(l[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===a)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},C.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},C.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},C.prototype.onAny=function(e){return this._onAny(e,!1)},C.prototype.prependAny=function(e){return this._onAny(e,!0)},C.prototype.addListener=C.prototype.on,C.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},C.prototype._on=function(e,t,n,r){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||p.call(this);var i,o=this;return r!==a&&(t=(i=A.call(this,e,t,r))[0],o=i[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(O.call(this,e,t),o):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,g.call(this,this._events[e].length,e))):this._events[e]=t,o)},C.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(r=M.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var s=r[o];if(n=s._listeners,l(n)){for(var a=-1,c=0,u=n.length;c<u;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){a=c;break}if(a<0)continue;return this.wildcard?s._listeners.splice(a,1):this._events[e].splice(a,1),0===n.length&&(this.wildcard?delete s._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete s._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&R(this.listenerTree),this},C.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},C.prototype.removeListener=C.prototype.off,C.prototype.removeAllListeners=function(e){if(e===a)return!this._events||p.call(this),this;if(this.wildcard){var t,n=M.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&R(this.listenerTree)}else this._events&&(this._events[e]=null);return this},C.prototype.listeners=function(e){var t,n,r,i,o,s=this._events;if(e===a){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!s)return[];for(i=(t=m(s)).length,r=[];i-- >0;)"function"==typeof(n=s[t[i]])?r.push(n):r.push.apply(r,n);return r}if(this.wildcard){if(!(o=this.listenerTree))return[];var c=[],l="string"==typeof e?e.split(this.delimiter):e.slice();return M.call(this,c,l,o,0),c}return s&&(n=s[e])?"function"==typeof n?[n]:n:[]},C.prototype.eventNames=function(e){var t=this._events;return this.wildcard?S.call(this,this.listenerTree,[],null,e):t?m(t):[]},C.prototype.listenerCount=function(e){return this.listeners(e).length},C.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return M.call(this,t,n,this.listenerTree,0),t.length>0}var r=this._events,i=this._all;return!!(i&&i.length||r&&(e===a?m(r).length:r[e]))},C.prototype.listenersAny=function(){return this._all?this._all:[]},C.prototype.waitFor=function(e,t){var n=this,r=s(t);return"number"===r?t={timeout:t}:"function"===r&&(t={filter:t}),L((t=_(t,{timeout:0,filter:a,handleError:!1,Promise:Promise,overload:!1},{filter:I,Promise:E})).Promise,(function(r,i,o){function s(){var o=t.filter;if(!o||o.apply(n,arguments))if(n.off(e,s),t.handleError){var a=arguments[0];a?i(a):r(y.apply(null,arguments).slice(1))}else r(y.apply(null,arguments))}o((function(){n.off(e,s)})),n._on(e,s,!1)}),{timeout:t.timeout,overload:t.overload})};var P=C.prototype;Object.defineProperties(C,{defaultMaxListeners:{get:function(){return P._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");P._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return L((n=_(n,{Promise:Promise,timeout:0,overload:!1},{Promise:E})).Promise,(function(n,r,i){var o;if("function"==typeof e.addEventListener)return o=function(){n(y.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var s,a=function(){s&&e.removeListener("error",s),n(y.apply(null,arguments))};"error"!==t&&(s=function(n){e.removeListener(t,a),r(n)},e.once("error",s)),i((function(){s&&e.removeListener("error",s),e.removeListener(t,a)})),e.once(t,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(P,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(o=function(){return C}.call(t,n,t,e))===a||(e.exports=o)}()}).call(this,n(1),n(13).setImmediate)},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}t.stringify=function(e,t){t=t||"";var n,i,o=[];for(i in"string"!=typeof t&&(t="?"),e)if(r.call(e,i)){if((n=e[i])||null!=n&&!isNaN(n)||(n=""),i=encodeURIComponent(i),n=encodeURIComponent(n),null===i||null===n)continue;o.push(i+"="+n)}return o.length?t+o.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var o=i(t[1]),s=i(t[2]);null===o||null===s||o in r||(r[o]=s)}return r}},function(e,t,n){var r,i;r=function(){var e="xPYMx",t={},n=function(e){var t=document.createEvent("Event");t.initEvent("pym:"+e,!0,!0),document.dispatchEvent(t)},r=function(e){var t=new RegExp("[\\?&]"+e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},i=function(e,t){if(("*"===t.xdomain||e.origin.match(new RegExp(t.xdomain+"$")))&&"string"==typeof e.data)return!0},o=function(e){var t=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi;if(e.match(t))return!0},s=function(t,n,r){return["pym",t,n,r].join(e)},a=function(t){return new RegExp("^"+["pym",t,"(\\S+)","(.*)"].join(e)+"$")},c=Date.now||function(){return(new Date).getTime()},l=function(e,t,n){var r,i,o,s=null,a=0;n||(n={});var l=function(){a=!1===n.leading?0:c(),s=null,o=e.apply(r,i),s||(r=i=null)};return function(){var u=c();a||!1!==n.leading||(a=u);var h=t-(u-a);return r=this,i=arguments,h<=0||h>t?(s&&(clearTimeout(s),s=null),a=u,o=e.apply(r,i),s||(r=i=null)):s||!1===n.trailing||(s=setTimeout(l,h)),o}},u=function(){for(var e=t.autoInitInstances.length-1;e>=0;e--){var n=t.autoInitInstances[e];n.el.getElementsByTagName("iframe").length&&n.el.getElementsByTagName("iframe")[0].contentWindow||t.autoInitInstances.splice(e,1)}};return t.autoInitInstances=[],t.autoInit=function(e){var r=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),i=r.length;u();for(var o=0;o<i;++o){var s=r[o];s.setAttribute("data-pym-auto-initialized",""),""===s.id&&(s.id="pym-"+o+"-"+Math.random().toString(36).substr(2,5));var a=s.getAttribute("data-pym-src"),c={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},l={};for(var h in c)if(null!==s.getAttribute("data-pym-"+h))switch(c[h]){case"boolean":l[h]=!("false"===s.getAttribute("data-pym-"+h));break;case"string":l[h]=s.getAttribute("data-pym-"+h);break;case"number":var f=Number(s.getAttribute("data-pym-"+h));isNaN(f)||(l[h]=f);break;default:console.err("unrecognized attribute type")}var d=new t.Parent(s.id,a,l);t.autoInitInstances.push(d)}return e||n("pym-initialized"),t.autoInitInstances},t.Parent=function(e,t,n){for(var r in this.id=e,this.url=t,this.el=document.getElementById(e),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=a(this.id),this.messageHandlers={},n=n||{},this._constructIframe=function(){var e=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var t="",n=this.url.indexOf("#");for(n>-1&&(t=this.url.substring(n,this.url.length),this.url=this.url.substring(0,n)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+e+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=t,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),void 0!==this.settings.allowfullscreen&&!1!==this.settings.allowfullscreen&&this.iframe.setAttribute("allowfullscreen",""),void 0!==this.settings.sandbox&&"string"==typeof this.settings.sandbox&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}.bind(this),this._onScroll=function(){this.sendViewportAndIFramePosition()}.bind(this),this._fire=function(e,t){if(e in this.messageHandlers)for(var n=0;n<this.messageHandlers[e].length;n++)this.messageHandlers[e][n].call(this,t)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),u()},this._processMessage=function(e){if(i(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(!t||3!==t.length)return!1;var n=t[1],r=t[2];this._fire(n,r)}}.bind(this),this._onHeightMessage=function(e){var t=parseInt(e);this.iframe.setAttribute("height",t+"px")},this._onNavigateToMessage=function(e){o(e)&&(document.location.href=e)},this._onScrollToChildPosMessage=function(e){var t=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset+parseInt(e);window.scrollTo(0,t)},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this.sendMessage=function(e,t){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(s(this.id,e,t),"*"):this.remove())},this.sendWidth=function(){var e=this.el.offsetWidth.toString();this.sendMessage("width",e)},this.sendViewportAndIFramePosition=function(){var e=this.iframe.getBoundingClientRect(),t=(window.innerWidth||document.documentElement.clientWidth)+" "+(window.innerHeight||document.documentElement.clientHeight);t+=" "+e.top+" "+e.left,t+=" "+e.bottom+" "+e.right,this.sendMessage("viewport-iframe-position",t)},n)this.settings[r]=n[r];return this._throttleOnScroll=l(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},t.Child=function(t){this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},t=t||{},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this._fire=function(e,t){if(e in this.messageHandlers)for(var n=0;n<this.messageHandlers[e].length;n++)this.messageHandlers[e][n].call(this,t)},this._processMessage=function(e){if(i(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(t&&3===t.length){var n=t[1],r=t[2];this._fire(n,r)}}}.bind(this),this._onWidthMessage=function(e){var t=parseInt(e);t!==this.parentWidth&&(this.parentWidth=t,this.settings.renderCallback&&this.settings.renderCallback(t),this.sendHeight())},this.sendMessage=function(e,t){window.parent.postMessage(s(this.id,e,t),"*")},this.sendHeight=function(){var e=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",e),e}.bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(e){this.sendMessage("navigateTo","#"+e)},this.navigateParentTo=function(e){this.sendMessage("navigateTo",e)},this.scrollParentToChildEl=function(e){var t=document.getElementById(e).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(t)},this.scrollParentToChildPos=function(e){this.sendMessage("scrollToChildPos",e.toString())};var o=function(e){var t,r=document.getElementsByTagName("html")[0],i=r.className;try{t=window.self!==window.top?"embedded":"not-embedded"}catch(o){t="embedded"}i.indexOf(t)<0&&(r.className=i?i+" "+t:t,e&&e(t),n("marked-embedded"))};for(var a in this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)},t)this.settings[a]=t[a];this.id=r("childId")||t.id,this.messageRegex=new RegExp("^pym"+e+this.id+e+"(\\S+)"+e+"(.*)$");var c=parseInt(r("initialWidth"));return this.parentUrl=r(this.settings.parenturlparam),this.parentTitle=r("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(c),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),o(t.onMarkedEmbeddedStatus),this},"undefined"!=typeof document&&t.autoInit(!0),t},void 0===(i="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=i)},,,,function(e,t,n){n(16),e.exports=n(15)},function(e,t,n){"use strict";n(11).polyfill()},function(e,t,n){"use strict";function r(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o=Object.keys(Object(i)),s=0,a=o.length;s<a;s++){var c=o[s],l=Object.getOwnPropertyDescriptor(i,c);void 0!==l&&l.enumerable&&(n[c]=i[c])}}return n}e.exports={assign:r,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}}},function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}!function(){"use strict";if("object"===("undefined"==typeof window?"undefined":n(window)))if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=window.document,t=[];i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i.prototype.observe=function(e){if(!this._observationTargets.some((function(t){return t.element==e}))){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter((function(t){return t.element!=e})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter((function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]}))},i.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map((function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}}));return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},i.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(e,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},i.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(window,"resize",this._checkForIntersections,!0),s(e,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},i.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var i=n.element,o=a(i),s=this._rootContainsTarget(i),c=n.entry,l=e&&s&&this._computeTargetAndRootIntersection(i,t),u=n.entry=new r({time:window.performance&&performance.now&&performance.now(),target:i,boundingClientRect:o,rootBounds:t,intersectionRect:l});c?e&&s?this._hasCrossedThreshold(c,u)&&this._queuedEntries.push(u):c&&c.isIntersecting&&this._queuedEntries.push(u):this._queuedEntries.push(u)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},i.prototype._computeTargetAndRootIntersection=function(t,n){if("none"!=window.getComputedStyle(t).display){for(var r,i,o,s,c,u,h,f,d=a(t),m=l(t),p=!1;!p;){var v=null,g=1==m.nodeType?window.getComputedStyle(m):{};if("none"==g.display)return;if(m==this.root||m==e?(p=!0,v=n):m!=e.body&&m!=e.documentElement&&"visible"!=g.overflow&&(v=a(m)),v&&(r=v,i=d,o=void 0,s=void 0,c=void 0,u=void 0,h=void 0,f=void 0,o=Math.max(r.top,i.top),s=Math.min(r.bottom,i.bottom),c=Math.max(r.left,i.left),u=Math.min(r.right,i.right),f=s-o,!(d=(h=u-c)>=0&&f>=0&&{top:o,bottom:s,left:c,right:u,width:h,height:f})))break;m=l(m)}return d}},i.prototype._getRootRect=function(){var t;if(this.root)t=a(this.root);else{var n=e.documentElement,r=e.body;t={top:0,left:0,right:n.clientWidth||r.clientWidth,width:n.clientWidth||r.clientWidth,bottom:n.clientHeight||r.clientHeight,height:n.clientHeight||r.clientHeight}}return this._expandRectByRootMargin(t)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map((function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100})),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},i.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var i=0;i<this.thresholds.length;i++){var o=this.thresholds[i];if(o==n||o==r||o<n!=o<r)return!0}},i.prototype._rootIsInDom=function(){return!this.root||c(e,this.root)},i.prototype._rootContainsTarget=function(t){return c(this.root||e,t)},i.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},i.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=r}function r(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,i=r.width*r.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0}function i(e,t){var n,r,i,o=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout((function(){n(),i=null}),r))}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map((function(e){return e.value+e.unit})).join(" ")}function o(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function s(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function a(e){var t;try{t=e.getBoundingClientRect()}catch(n){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(e,t){for(var n=t;n;){if(n==e)return!0;n=l(n)}return!1}function l(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t&&t.assignedSlot?t.assignedSlot.parentNode:t}}()},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(14),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(2))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,s,a,c=1,l={},u=!1,h=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){m(e.data)},r=function(e){o.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(e){var t=h.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(m,0,e)}:(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&m(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(s+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[c]=i,r(c),c++},f.clearImmediate=d}function d(e){delete l[e]}function m(e){if(u)setTimeout(m,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{d(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(2),n(1))},function(e,t,n){"use strict";n.r(t),n.d(t,"createStreamEmbed",(function(){return G}));var r=n(3),i=n(4),o=n.n(i);function s(e){return e.location.origin||"".concat(e.location.protocol,"//").concat(e.location.host)}var a=function(e){var t=e.document.querySelector('link[rel="canonical"]');return t?t.href:(console.warn("This page does not include a canonical link tag. Coral has inferred this story_url from the window object. Query params have been stripped, which may cause a single thread to be present across multiple pages."),s(e)+e.location.pathname)};function c(e,t){var n={};return Object.keys(e).forEach((function(t){void 0!==e[t]&&(n[t]=e[t])})),o.a.stringify(n,t)}function l(e){return e.replace(/\/$/,"")}var u={stream:"/embed/stream",auth:"/embed/auth",deleteAccount:"/embed/deleteAccount"},h=function(e){e.el.firstChild.style.width="1px",e.el.firstChild.style.minWidth="100%"},f=function(e){return function(t){var n;t.onMessage("height",(function(r){if(r!==n){n=r;var i=parseInt(r,10);t.iframe.style.height="".concat(i,"px"),e&&window.parent.postMessage({sentinel:"amp",type:"embed-size",height:i>100?i:100},"*")}}))}},d=function(e){var t=function(){return e.sendMessage("click","")};return document.addEventListener("click",t,!0),function(){document.removeEventListener("click",t,!0)}};function m(e,t,n){return e.substr(!n||n<0?0:+n,t.length)===t}var p=function(e){e.onMessage("setCommentID",(function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.protocol,n=void 0===t?window.location.protocol:t,r=e.hostname,i=void 0===r?window.location.hostname:r,o=e.port,s=void 0===o?window.location.port:o,a=e.pathname,c=void 0===a?window.location.pathname:a,l=e.search,u=void 0===l?window.location.search:l,h=e.hash,f=void 0===h?window.location.hash:h;return u&&!m(u,"?")?u="?".concat(u):"?"===u&&(u=""),m(c,"/")||(c="/"+c),"".concat(n,"//").concat(i).concat(s?":".concat(s):"").concat(c).concat(u).concat(f)}({search:c(Object.assign(Object.assign({},Object(i.parse)(location.search)),{commentID:e||void 0}))});window.history.pushState({},document.title,t)}));var t=function(t){var n=Object(i.parse)(location.search).commentID;e.sendMessage("setCommentID",n||"")};return window.addEventListener("popstate",t),function(){window.removeEventListener("popstate",t)}},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){n.onMessage("event",(function(n){var r=JSON.parse(n),i=r.eventName,o=r.value;if(!t){if(m(i,"mutation."))return;if(m(i,"fetch."))return;if(m(i,"subscription."))return}e.emit(i,o)})),n.onMessage("ready",(function(){e.emit("ready")}))}},g=".coral-count",y=function(e){return function(){e.on("commentCount",(function(e){document.querySelectorAll("".concat(g,"[data-coral-url='").concat(e.storyURL,"'], ").concat(g,"[data-coral-id='").concat(e.storyID,"']")).forEach((function(t){t.querySelectorAll(".coral-count-number").forEach((function(t){t.innerHTML=e.number})),t.querySelectorAll(".coral-count-text").forEach((function(t){t.innerHTML=e.text}))}))}))}};function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b(this,e),this.data=t}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this.data={}}},{key:"key",value:function(e){return this.length<=e?null:Object.keys(this.data)[e]}},{key:"getItem",value:function(e){return this.data[e]||null}},{key:"setItem",value:function(e,t){this.data[e]=t}},{key:"removeItem",value:function(e){delete this.data[e]}},{key:"toString",value:function(){return JSON.stringify(this.data)}},{key:"length",get:function(){return Object.keys(this.data).length}}])&&w(t.prototype,n),r&&w(t,r),e}();function E(e){return new _(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage=t,this.prefix=n}var t,n,r;return t=e,(n=[{key:"clear",value:function(){for(var e=this,t=[],n=0;n<this.storage.length;n++){var r=this.storage.key(n);m(r,this.prefix)&&t.push(r)}t.forEach((function(t){return e.storage.removeItem(t)}))}},{key:"key",value:function(e){for(var t=0,n=0;n<this.storage.length;n++){var r=this.storage.key(n);if(m(r,this.prefix)){if(t===e)return r;t++}}return null}},{key:"getItem",value:function(e){return this.storage.getItem("".concat(this.prefix).concat(e))}},{key:"setItem",value:function(e,t){return this.storage.setItem("".concat(this.prefix).concat(e),t)}},{key:"removeItem",value:function(e){return this.storage.removeItem("".concat(this.prefix).concat(e))}},{key:"length",get:function(){for(var e=0,t=0;t<this.storage.length;t++)m(this.storage.key(t),this.prefix)&&e++;return e}}])&&k(t.prototype,n),r&&k(t,r),e}();function T(e,t){return new I(e,t)}var L=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"coral:";return function(r,i){var o=e?T(e,n):E();i.on("postMessageStorage.".concat(t,".request"),(function(e){var n,r=e.id,s=e.method,a=e.parameters,c=a.n,l=a.key,u=a.value,h=function(e){console.error(e),i.send("postMessageStorage.".concat(t,".error"),{id:r,error:e})};try{switch(s){case"setItem":n=o.setItem(l,u);break;case"getItem":n=o.getItem(l);break;case"removeItem":n=o.removeItem(l);break;case"key":n=o.key(c);break;case"length":n=o.length;break;case"clear":n=o.clear();break;default:return void h("Unknown method ".concat(s))}}catch(f){return void h(f.toString())}i.send("postMessageStorage.".concat(t,".response"),{id:r,result:n})}))}};function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}x(window.indexedDB);var M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"coral:keyvalue";return function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.indexedDB,o=[];if(i){var s=i.open(e,1);s.onerror=function(e){console.error(this.error)},s.onsuccess=function(e){r=s.result,o.forEach((function(e){return e()})),o=[]},s.onupgradeneeded=function(e){s.result.createObjectStore("keyvalue")}}var a=function(e,t,o){var s,a=o.key,c=o.value,l=function(t){console.error(t),n.send("postMessageStorage.indexedDB.error",{id:e,error:t})};r||l(i?"IndexedDB not yet initialized.":"IndexedDB not supported.");try{switch(t){case"setItem":s=r.transaction("keyvalue","readwrite").objectStore("keyvalue").put(c,a);break;case"getItem":s=r.transaction("keyvalue","readonly").objectStore("keyvalue").get(a);break;case"removeItem":s=r.transaction("keyvalue","readwrite").objectStore("keyvalue").delete(a);break;case"key":return void l("key() not implemented");case"length":s=r.transaction("keyvalue","readonly").objectStore("keyvalue").count();break;case"clear":s=r.transaction("keyvalue","readwrite").objectStore("keyvalue").clear();break;default:return void l("Unknown method ".concat(t))}}catch(u){return void l(u.toString())}s.onerror=function(){this.error?l(this.error.toString()):l("Uknown error")},s.onsuccess=function(r){var i=r.target.result;"setItem"===t?i=void 0:"getItem"===t&&void 0===i&&(i=null),n.send("postMessageStorage.indexedDB.response",{id:e,result:i})}};n.on("postMessageStorage.indexedDB.request",(function(e){var t=e.id,n=e.method,s=e.parameters,c=function(){return a(t,n,s)};r||!i?c():o.push((function(){return c()}))}))}},O=function(e){return function(t){t.onMessage("getConfig",(function(){t.sendMessage("config",JSON.stringify(e))}))}};function S(e,t,n){var r=new IntersectionObserver((function(e){t(e[0].isIntersecting)}),n);return r.observe(e),function(){return r.disconnect()}}var R=function(e){var t=function(t){if(t.target){var n=t.target;if("INPUT"===n.tagName||"TEXTAREA"===n.tagName)return;if(n.isContentEditable)return}var r={key:t.key,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey};e.sendMessage("keypress",JSON.stringify(r))},n=S(e.el,(function(e){e?document.addEventListener("keypress",t):document.removeEventListener("keypress",t)}),{rootMargin:"-100px -20px"});return function(){n(),document.removeEventListener("keypress",t)}},j={zIndex:"999999",position:"fixed",visibility:"hidden",pointerEvents:"none"},A={modal:{inViewOnly:!1,disableScroll:!0,style:{left:"0px",top:"0px",width:"100%",height:"100%"}},footer:{inViewOnly:!0,disableScroll:!1,style:{left:"0px",bottom:"0px",height:"52px",width:"100%"}}},C=Object.keys(A);function P(e,t){var n={};return C.forEach((function(r){var i=function(e,t,n){var r=document.createElement("iframe");r.src=e+"&renderTarget=true",r.id=t,r.name=t,r.allowTransparency="true",r.frameBorder="0";var i=Object.assign(Object.assign({},j),n.style);return Object.keys(i).forEach((function(e){r.style[e]=i[e]})),r}(e,"".concat(t,"_iframe_").concat(r),A[r]);n[r]=i,document.body.appendChild(i)})),n}var N=function(e,t){return function(n){var r=P(e,t),i=[],o=C.some((function(e){return A[e].inViewOnly}))?S(n.el,(function(e){C.forEach((function(t){var n=r[t];n&&A[t].inViewOnly&&(n.style.display=e?"block":"none")}))}),{rootMargin:"-100px -20px"}):function(){};if(!document.getElementById("coral-embed-style")){var s=document.getElementsByTagName("head");if(s.length>0){var a=s[0],c=document.createElement("style");c.id="coral-embed-style",c.type="text/css",c.innerHTML="body.coralBodyNoScroll { overflow: hidden; !important }",a.appendChild(c)}else console.warn("Coral: Head Element was not found.")}return n.onMessage("renderTargetAction",(function(e){var t=JSON.parse(e),n=t.action,o=t.target,s=r[o],a=A[o].disableScroll;if(!s)throw new Error("Iframe ".concat(o," not found"));switch(n){case"show":s.style.visibility="visible",s.style.pointerEvents="auto",a&&(i.push(o),1===i.length&&(window.document.body.className="".concat(window.document.body.className," coralBodyNoScroll")));break;case"hide":if(s.style.visibility="hidden",s.style.pointerEvents="none",a){var c=i.indexOf(o);c>-1&&i.splice(c,1),0===i.length&&(window.document.body.className=window.document.body.className.replace(/ ?coralBodyNoScroll/g,""))}break;default:throw new Error("Unknown render target action ".concat(n))}})),function(){o(),Object.keys(r).forEach((function(e){var t=r[e].parentNode;t&&t.removeChild(r[e])}))}}},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){t.onMessage("getRefreshAccessToken",(function(){if(e){var n=!1;e((function(e){if(n)throw new Error("next access token has been already provided");n=!0,t.sendMessage("refreshAccessToken",e)}))}else t.sendMessage("refreshAccessToken","")}))}};var B=function(e){return void 0!==e.CoralCount},D=function(e){if(!B(window)&&document.querySelector(g)){var t=document.createElement("script");t.src="".concat(e,"/assets/js/count.js"),t.className="coral-script",t.async=!1,t.defer=!0,(document.head||document.body).appendChild(t)}};function H(e,t,n){var r=S(e,(function(e){e&&(r(),t())}),n);return r}var F=n(5),W=n.n(F);function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.window=t,this.scope=n,this.defaultTarget=r,this.defaultTargetOrigin=i}var t,n,r;return t=e,n=[{key:"send",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*";if(!n){if(!this.defaultTargetOrigin)return;n=this.defaultTarget,r=this.defaultTargetOrigin}var i={name:e,value:t,scope:this.scope};n.postMessage(i,r)}},{key:"on",value:function(e,t){var n=this,r=function(r){r.data&&"string"==typeof r.data.scope&&r.data.scope===n.scope&&r.data.name===e&&t(r.data.value,r.data.name)};return this.window.addEventListener("message",r),function(){n.window.removeEventListener("message",r)}}}],n&&q(t.prototype,n),r&&q(t,r),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=function(e){return new $(e)},$=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rendered=!1,this.id=t.id,this.url=t.url,this.title=t.title,this.decorators=t.decorators}var t,n,r;return t=e,n=[{key:"render",value:function(){if(!this.rendered){var e,t,n="".concat(this.id,"_iframe"),r=new W.a.Parent(this.id,this.url,{title:this.title,id:n,name:n}),i=r.iframe,o=new V(window,"coral",i.contentWindow,(e=i.src,t=e.split("/"),"".concat(t[0],"//").concat(t[2]))),s=this.decorators.map((function(e){return e(r,o)})).filter((function(e){return!!e}));this.rendered=!0,this.parent=r,this.cleanups=s}}},{key:"sendMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!this.rendered||!this.parent)throw new Error("not mounted");this.parent.sendMessage(e,t)}},{key:"remove",value:function(){if(!this.rendered||!this.parent||!this.cleanups)throw new Error("not mounted");this.cleanups.forEach((function(e){return e()})),this.cleanups=null,this.parent.remove(),this.parent=null,this.rendered=!1}}],n&&z(t.prototype,n),r&&z(t,r),e}();var J=function(e){var t;try{t=window[e]}catch(n){console.debug("".concat(e," not available, use in-memory replacement")),t=E()}return t};function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;Y(this,e),this.requestExpiryInterval=9e5,this.ready=!1,this.clearAutoRender=null;var i=document.getElementById(t.id);if(!i)throw new Error("element ".concat(t.id," was not found"));this.eventEmitter=t.eventEmitter,t.eventEmitter.once("ready",(function(){n.ready=!0}));var o=c({storyID:t.storyID,storyURL:t.storyURL,storyMode:t.storyMode,commentID:t.commentID,customCSSURL:t.customCSSURL,v:"6.16.2",ts:Math.round(Date.now()/this.requestExpiryInterval)*this.requestExpiryInterval}),s=l(t.rootURL)+u.stream,a="".concat(s,"?").concat(o),m=[h,f(Boolean(t.amp)),d,p,v(t.eventEmitter,t.enableDeprecatedEvents),y(t.eventEmitter),L(J("localStorage"),"localStorage"),L(J("sessionStorage"),"sessionStorage"),M(),O({accessToken:t.accessToken,bodyClassName:t.bodyClassName,version:"6.16.2",amp:Boolean(t.amp)}),R,U(t.refreshAccessToken),N(a,t.id)];this.control=r({id:t.id,title:t.title,decorators:m,url:a}),D(t.rootURL),t.commentID&&setTimeout((function(){return t.eventEmitter.emit("showPermalink")}),0),t.autoRender&&(t.commentID?this.render():this.clearAutoRender=H(i,(function(){n.clearAutoRender=null,n.render()}),{rootMargin:"100px",threshold:1}))}var t,n,r;return t=e,(n=[{key:"on",value:function(e,t){return this.eventEmitter.on(e,t)}},{key:"off",value:function(e,t){return this.eventEmitter.off(e,t)}},{key:"login",value:function(e){var t=this;this.ready?this.control.sendMessage("login",e):this.eventEmitter.once("ready",(function(){t.control.sendMessage("login",e)}))}},{key:"logout",value:function(){var e=this;this.ready?this.control.sendMessage("logout"):this.eventEmitter.once("ready",(function(){e.control.sendMessage("logout")}))}},{key:"remove",value:function(){if(this.clearAutoRender)return this.clearAutoRender(),void(this.clearAutoRender=null);if(!this.control.rendered)throw new Error("instance not mounted");this.control.remove()}},{key:"render",value:function(){this.control.rendered||this.control.render()}},{key:"rendered",get:function(){return this.control.rendered}}])&&Q(t.prototype,n),r&&Q(t,r),e}();function G(e){var t=Object(i.parse)(location.search),n=new r.EventEmitter2({wildcard:!0});return e.events&&e.events(n),new X({title:"Coral Embed Stream",storyID:e.storyID||t.storyID,storyURL:e.storyURL||t.storyURL||a(window),storyMode:e.storyMode||void 0,commentID:e.commentID||t.commentID,id:e.id||"coral-embed-stream",rootURL:e.rootURL||s(window),autoRender:e.autoRender,eventEmitter:n,accessToken:e.accessToken,bodyClassName:e.bodyClassName,enableDeprecatedEvents:e.enableDeprecatedEvents,customCSSURL:e.customCSSURL,refreshAccessToken:e.refreshAccessToken,amp:e.amp})}},function(e,t,n){"use strict";n.r(t);n(10),n(12);"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)})}]);
//# sourceMappingURL=embed.js.map