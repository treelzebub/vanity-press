"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7603],{34705:function(e,s,t){t.d(s,{Z:function(){return y}});var n=t(59499),r=t(67294),i=t(29208),a=t.n(i),o=t(23561),c=t(13216),l=t(11657),d=t(18939),h=t(85893);var b=t(93754),m=t(92303),p=t(25715);function g(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);s&&(n=n.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,n)}return t}function u(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?g(Object(t),!0).forEach((function(s){(0,n.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}let f=!1;const _=(0,c.TE)({appName:"OSN"});class w extends r.Component{constructor(e){var s;super(e),s=this,(0,n.Z)(this,"checkDisplayStatus",(e=>{"softwall"===e.name&&!0===e.readyDisplay?6===this.state.action&&(window.wpMetaData.sct_tags+=this.state.sct_tags,window.extListener&&window.extListener({action:this.state.action}),this.setState({action:0}),window.registerDisplay({participant:"osn",status:"final"})):"osn"===e.name&&!0===e.readyDisplay&&(this.setState({displayReady:!0}),window.registerDisplay({participant:"softwall",status:"final"}))})),(0,n.Z)(this,"checkUserMessages",(e=>{let{action:s,osnAction:t}=e;if(s>0)return Promise.resolve();const n=this.props.siteProperties.account.osnUrl[(0,b.Z)()];return(0,d.$8)()?fetch(n,{credentials:"include"}).then((e=>e.json())).then((e=>this.parseMessages(e,t))).catch((()=>{this.generatePwapiOsns(t)})):(this.generatePwapiOsns(t),Promise.resolve())})),(0,n.Z)(this,"checkPwapiAndOSNMessage",(e=>{if("final"===e.status&&0===e.action){this.setState({showOSN:!1,action:e.action});let n={};try{n=JSON.parse(localStorage.getItem("wapo_identity")||"{}")}catch(t){console.warn("[OSN] Error parsing wapo_identity from local storage",t)}const r=n.flags||[];this.checkUserMessages({osnAction:0,action:e.action||0}).then((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.some((e=>["CANCEL","SUSPEND"].includes(e)))||t.length&&e.data&&!e.data.isSubscriber?s.setState({showOSN:!0}):t.some((e=>["START"].includes(e)))&&!r.includes("cp_selected")&&e.data&&e.data.isSubscriber&&(s.setState({action:6}),s.setState({sct_tags:`,${r.join(",")},onboarding`}),window.registerDisplay({participant:"softwall",status:"ready"}))})).finally((()=>{!0===this.state.showOSN&&window.registerDisplay({participant:"osn",status:"ready"})}))}else"error"===e.status&&window.registerDisplay({participant:"osn",status:"final"})})),(0,n.Z)(this,"getTimingValues",((e,s)=>{if(!e)return{};const t=e-s,n=e-(new Date).getTime(),r=(new Date).getTime()-s,i=Math.floor(n/t);let a=n/36e5;a=a>0?Math.round(a):0;let o=n/864e5;o=o>0?Math.round(o):0;const c=r/864e5;return{validUntil:new Date(e).toLocaleDateString("en-us",{month:"long",day:"numeric",year:"numeric"}),daysRemaining:o,daysSince:c,hoursRemaining:a,fractionRemaining:i}})),(0,n.Z)(this,"generateOsnUi",(e=>{const s=this.getTimingValues(e.messageExpire||e.expirationDate,e.messageDate),t=function(e){return{START:[{message:(0,h.jsx)(r.Fragment,{children:(0,h.jsx)("div",{className:"bold dib-l",children:"Get the most from your subscription. Access exclusive features in our mobile app."})}),button:(0,h.jsx)("a",{href:"https://wapo.onelink.me/e76N/subsosn?itid=ntfn_start_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Read in App"}),reason:"ntfn_start_2",gaReason:"on_start_2",classNames:"bg-blue white",trigger:"daysSince",thresholds:[4,32,62,92,122,152]},{message:(0,h.jsx)(r.Fragment,{children:(0,h.jsx)("div",{className:"bold dib-l",children:"Get the most from your subscription. Update your email newsletters and alerts any time."})}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/newsletters/#/newsletters?method=MP&location=WELE_ON&tid=ntfn_start_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Update now"}),classNames:"bg-blue white",reason:"ntfn_start_1",gaReason:"on_start_1",trigger:"daysSince",thresholds:[2,30,60,90,120,150]}],FIRSTUPC:[{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"Thanks for reading.\xa0"}),(0,h.jsxs)("div",{className:"dib-l",children:["Try one month of unlimited access for"," ",(0,h.jsx)("span",{className:"o-50 strike",children:"$10"})," $1."]})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition/?promo=o16&tid=ntfn_first_upc",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"View Offer"}),reason:"ntfn_first_upc",gaReason:"on_first_upc",classNames:"bg-blue white",show:"once"}],SUSPEND:[{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"We were unable to process your last payment.\xa0"}),(0,h.jsx)("div",{className:"dib-l",children:"Update your payment method to keep your access."})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/account/subscription/?manage=payment-method&itid=ntfn_suspended_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Update my payment"}),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_1",gaReason:"on_suspend_1",show:"once"},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"Your account still has payment issues.\xa0"}),(0,h.jsx)("div",{className:"dib-l",children:"Update your payment method to keep your access."})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/account/subscription/?manage=payment-method&itid=ntfn_suspended_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Update my payment"}),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_2",gaReason:"on_suspend_2",trigger:"fractionRemaining",threshold:.49},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Update your payment method in ",e.hoursRemaining," hours to keep your access.\xa0"]}),(0,h.jsx)("div",{className:"dib-l",children:"Update your payment method to keep your access."})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/account/subscription/?manage=payment-method&itid=ntfn_suspended_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Update my payment"}),classNames:"bg-red-pale red-dark",reason:"ntfn_suspended_subscriber_3",gaReason:"on_suspend_3",trigger:"hoursRemaining",threshold:24}],CANCEL:[{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"dib-l",children:"You\u2019ve canceled your subscription.\xa0"}),(0,h.jsxs)("div",{className:"bold dib-l",children:["Reactivate by ",e.validUntil," to keep access."]})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"See my rate"}),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_1",gaReason:"on_cancel_1",show:"once"},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Reactivate your subscription by ",e.validUntil," to keep access."]}),(0,h.jsx)("div",{className:"dib-l",children:"\xa0"})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"See my rate"}),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_2",gaReason:"on_cancel_2",trigger:"daysRemaining",threshold:15},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Reactivate your subscription in the next ",e.daysRemaining,"days to keep access."]}),(0,h.jsx)("div",{className:"dib-l",children:"\xa0"})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"See my rate"}),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_3",gaReason:"on_cancel_3",trigger:"daysRemaining",threshold:7},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["You\u2019ve canceled your subscription and access ends in"," ",e.hoursRemaining,". Reactivate now to keep access."]}),(0,h.jsx)("div",{className:"dib-l",children:"\xa0"})]}),button:(0,h.jsx)("a",{href:"https://www.washingtonpost.com/my-post/reactivate?tid=ntfn_cancelled_subscriber_4",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"See my rate"}),classNames:"bg-red-pale red-dark",reason:"ntfn_cancelled_subscriber_4",gaReason:"on_cancel_4",trigger:"hoursRemaining",threshold:24}],FREETRIAL:[{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"Welcome to your free trial of The Washington Post.\xa0"}),(0,h.jsxs)("div",{className:"dib-l",children:["Enjoy free digital access until ",e.validUntil,"."]})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_1",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"View offer"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_1",gaReason:"on_free_trial_1",show:"once"},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"We hope you're enjoying your free trial.\xa0"}),(0,h.jsxs)("div",{className:"dib-l",children:["Subscribe to keep your access past ",e.validUntil,"."]})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_2",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"View offer"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_2",gaReason:"on_free_trial_2",trigger:"fractionRemaining",threshold:.99},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Your free trial expires in ",e.daysRemaining," days.\xa0"]}),(0,h.jsx)("div",{className:"dib-l",children:"Subscribe to keep your access."})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_3",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"View offer"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_3",gaReason:"on_free_trial_3",trigger:"fractionRemaining",threshold:.5},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Your free trial expires in ",e.daysRemaining," days.\xa0"]}),(0,h.jsxs)("div",{className:"dib-l",children:["Subscribe to enjoy your access past ",e.validUntil,"."]})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_4",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"View offer"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_4",gaReason:"on_free_trial_4",trigger:"fractionRemaining",threshold:.25},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsx)("div",{className:"bold dib-l",children:"Your free trial expires soon.\xa0"}),(0,h.jsxs)("div",{className:"bodl dib-l",children:["Subscribe to keep your access past ",e.validUntil,"."]})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_5",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Renew Now"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_5",gaReason:"on_free_trial_5",trigger:"fractionRemaining",threshold:.05},{message:(0,h.jsxs)(r.Fragment,{children:[(0,h.jsxs)("div",{className:"bold dib-l",children:["Hurry! Your free trial expires in ",e.hoursRemaining," hours. Keep reading for just ",(0,h.jsx)("span",{className:"o-50 strike",children:"$10"}),"\xa0$1."]}),(0,h.jsx)("div",{className:"dib-l",children:"\xa0"})]}),button:(0,h.jsx)("a",{href:"https://subscribe.washingtonpost.com/acquisition?promo=osn_r_tftp&itid=ntfn_free_trial_subscriber_6",className:"btn btn-white db dib-ns",target:"_blank",rel:"noopener noreferrer",children:"Renew Now"}),classNames:"bg-blue white",reason:"ntfn_free_trial_subscriber_6",gaReason:"on_free_trial_6",trigger:"hoursRemaining",threshold:24}]}}(s);if(t[e.useCase]){const n=t[e.useCase].filter((t=>{if(e.messageExpire&&e.messageExpire<(new Date).getTime())return!1;if(this.isDismissed(e.id,t.reason))return!1;if(t.trigger&&t.threshold&&s[t.trigger]>t.threshold)return!1;if(t.trigger&&t.thresholds&&Array.isArray(t.thresholds)){const n=t.thresholds.find(((e,n)=>{const r=t.thresholds[n+1];return e<=s[t.trigger]&&(!r||s[t.trigger]<r)}));if(!n)return!1;if(t.reason+=`_${n}`,t.gaReason+=`_${n}`,this.isDismissed(e.id,t.reason))return!1}return t}));if(n&&n.length){e=u(u({},e),n.pop()),this.setState(e);const s=a()(e,"gaReason","");"once"===e.show&&this.dismissMessageLocal(e.id,e.reason),(0,l.Nf)("notification-display","notification",s,{event:"acquisition-notification-display"})}}})),(0,n.Z)(this,"generatePwapiOsns",(e=>{const s=1===e?"FIRSTUPC":null;s&&this.generateOsnUi({useCase:s,id:s})})),(0,n.Z)(this,"parseMessages",((e,s)=>{const t=this.state.isTetroOSN?["START"]:["CANCEL","SUSPEND","START"];e.messages=e.messages||[];const n=[],r=e.messages.map((e=>(n.push(e.useCase),-1!==t.indexOf(e.useCase)&&("START"===e.useCase&&"Y"===e.isFreeTrial&&(e.useCase="FREETRIAL"),e))));return r.length>0?this.generateOsnUi(r[0]):this.generatePwapiOsns(s),n})),(0,n.Z)(this,"dismiss",(()=>{this.dismissMessageLocal(this.state.id,this.state.reason),(0,l.Nf)("notification-close","notification",this.state.gaReason,{event:"acquisition-notification-close"})})),(0,n.Z)(this,"isDismissed",((e,s)=>a()(this.dismissedMessages,`${e}.reason.${s}`))),(0,n.Z)(this,"dismissMessageLocal",((e,s)=>{this.dismissedMessages[e]=this.dismissedMessages[e]||{},this.dismissedMessages[e].reason=this.dismissedMessages[e].reason||{},this.dismissedMessages[e].reason[s]=!0,localStorage.setItem("userMessages",JSON.stringify(this.dismissedMessages))})),this.state={}}componentDidMount(){const e=(0,m.Z)("wp_ak_osn"),s=(0,m.Z)("wapo_login_id"),t=!(!e||!e.startsWith("1|"));this.setState({osnCookie:e,wapoLoginID:s,isTetroOSN:t}),this.dismissedMessages=(0,p.e)()&&JSON.parse(localStorage.getItem("userMessages"))||{},window.registerExtUpdates?window.registerExtUpdates(this.checkPwapiAndOSNMessage):(window.extConsumers=window.extConsumers||[],window.extConsumers.push(this.checkPwapiAndOSNMessage)),window.registerDisplay&&(window.registerDisplay({participant:"softwall",callback:this.checkDisplayStatus}),window.registerDisplay({participant:"osn",callback:this.checkDisplayStatus}))}render(){const{message:e,showOSN:s,classNames:t,button:n,displayReady:r}=this.state;return e&&s&&r?((e=>{let{action:s,gaReason:t,osnCookie:n,wapoLoginID:r}=e;f||(_.logInfo({location:"spectrum",message:`${r} ${n} ${s} ${t}`}),f=!0)})(this.state),(0,h.jsx)("div",{style:{marginTop:"60px",position:"absolute",width:"100%",zIndex:"100"},"data-qa":"osn",children:(0,h.jsx)(o.Banner,{classNames:`pa-sm hide-for-print ${t}`,dismiss:this.dismiss,iconClasses:"close brad-50 pa-xxs ml-sm pointer fr",iconFill:"white",iconStyle:{background:"rgba(0,0,0,0.2)"},children:(0,h.jsxs)("div",{className:"flex-ns flex-1 items-center",children:[(0,h.jsx)("div",{className:"flex-1 justify-start",children:(0,h.jsx)("div",{children:e})}),(0,h.jsx)("div",{className:"justify-end",children:n})]})})})):null}}var y=w},92038:function(e,s,t){var n=t(67294),r=t(90150);class i extends n.Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,s){window.Sentry&&window.Sentry.withScope((t=>{t.setExtras(s),window.Sentry.captureException((0,r.Z)(e,"Component"))})),this.setState({hasError:!0})}render(){return this.state.hasError?this.props.fallbackComponent||null:this.props.children}}s.Z=i},90150:function(e,s,t){class n extends Error{constructor(e,s){super(),this.name=s,this.message=e}}s.Z=(e,s)=>{const t=`SpectrumReactError ${e.message}`;return new n(t,`SpectrumReactError${s}:`)}}}]);